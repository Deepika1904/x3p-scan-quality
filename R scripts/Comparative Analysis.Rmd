---
title: "Comparitive Analysis"
author: "Craig Orman, Naga Vempati, Dr. Heike Hofmann"
date: "2022-12-09"
output: html_document
---


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
if (!require(fastDummies)) install.packages('fastDummies')
if (!require(tidyverse)) install.packages('tidyverse')
if (!require(ggplot2)) install.packages('ggplot2')
if (!require(ggpubr)) install.packages('ggpubr')
library(fastDummies)
library(tidyverse)
library(ggplot2)
library(ggpubr)

```

Staging
```{r}
full_data = read.csv(file = "../data/std_and_cropped_data_12_20_2022.csv", header=TRUE)
```

```{r}

full_data = full_data %>% mutate(
  Quality = factor(Quality, levels=c("Good", "Tiny Problems", "Problematic", "Bad", "Yikes")),
  Problem = factor(Problem)
)

```


## Functions
```{r}
comparison <- function(standard, cropped, feature) {

upper = max(max(standard), max(cropped))
upper = upper * 1.1
scatty = full_data %>% ggplot(aes(x=standard, y=cropped, col = Quality, group = 1)) +
  geom_point() +
  xlim(0,upper) +
  ylim(0,upper) +
  ggtitle(feature) +
  geom_smooth(method=lm, se = FALSE, aes(group = 1)) +
  stat_regline_equation(label.y = upper, aes(label = ..eq.label..)) +
  stat_regline_equation(label.y = upper*0.9, aes(label = ..rr.label..))

boxy = boxplot(standard, cropped,
        horizontal = TRUE,
        main = feature,
        names = c("Standard", "Cropped"),
        col = c("red", "blue"))
        
print(scatty)
boxy
df = data.frame(min = numeric(),
                firstQ = numeric(),
                med = numeric(),
                mean = numeric(),
                thirdQ = numeric(),
                max = numeric())

print(paste("Summary Info of", feature))
df[1,] = summary(standard)
df[2,] = summary(cropped)
rownames(df) = c("Standard", "Cropped")
print(df)
}
```

```{r}
comparison(full_data$extract_na, full_data$extract_na_cropped, feature = "Extract NA")
comparison(full_data$assess_percentile_na_proportion, full_data$assess_percentile_na_proportion_cropped, feature = "Assess percentile NA proportion")
comparison(full_data$assess_col_na, full_data$assess_col_na_cropped, feature = "assess col NA")
comparison(full_data$assess_bottomempty, full_data$assess_bottomempty_cropped, feature = "Bottom Empty")
comparison(full_data$assess_median_na_proportion, full_data$assess_median_na_proportion_cropped, feature = "Assess median NA proportion")
```



